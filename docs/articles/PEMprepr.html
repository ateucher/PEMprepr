<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PEMprepr">
<title>PEMprepr • PEMprepr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PEMprepr">
<meta property="og:description" content="PEMprepr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PEMprepr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.91117</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/PEMprepr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>PEMprepr</h1>
            <h3 data-toc-skip class="subtitle">Example workflow</h3>
            
      
      
      <div class="d-none name"><code>PEMprepr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PEMprepr</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<p><code>PEMprepr</code>, short for <em>Predictive Ecosystem Mapping –
Preparation</em> is the first of a series of packages supporting the
British Columbia Biogeoecosystem Classification’s<br>
Predictive Ecosystem Mapping (PEM) project. See <a href="https://www.for.gov.bc.ca/HRE/becweb/index.html" class="external-link">BC-BEC</a> and <a href="https://github.com/bcgov/PEMr" class="external-link"><code>PEMr</code></a> on
_GitHub_for details about the BC BEC classification system and, the PEM
Project.</p>
<p>A portion of the <a href="aleza.unbc.ca">Aleza Lake Research
Forest</a>, one of the pilot study sites for this project, is used for
this example. The area outlined in red will be used in the steps
below</p>
<p>In the example below it is assumed that you are running the following
within a new R project.</p>
<div class="figure" style="text-align: center">
<img src="aleza.png" alt="The Aleza Lake Research forest with the area of interest outlined in red" width="300"><p class="caption">
The Aleza Lake Research forest with the area of interest outlined in red
</p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The following provides a standard workflow for preparing data for
subsequent sampling, modeling, and mapping. The key steps demonstrated
below include:</p>
<ol style="list-style-type: decimal">
<li>Data folder set up.</li>
<li>Alignment of the area of interest</li>
<li>Generation of covariates</li>
<li>Creation of a multi-resolution raster stack</li>
<li>Collection of vector data.</li>
</ol>
</div>
<div class="section level2">
<h2 id="folder-setup">Folder setup<a class="anchor" aria-label="anchor" href="#folder-setup"></a>
</h2>
<p>Data for the project can quickly become difficult to manage. To
facilitate ease of data management a standard set of folders for each
area of interest. The following creates the needed folders for the area
of interest: <em>aleza</em>. In addition, <code>fstr</code> stores a
named list of the folders created which we will utilize later (e.g. to
programmatically place results of functions in the correct place).</p>
<p>_Note: if the folders have been generated previously this function
will still return the list of folder names.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># creates dirs and returns a named list</span></span>
<span><span class="va">fstr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setup_folders.html">setup_folders</a></span><span class="op">(</span><span class="st">"aleza"</span>,            </span>
<span>                      full_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># relative or full path</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fstr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="co">## first 5 in the list. </span></span>
<span><span class="co">#&gt; [1] "The aleza folder already exists - returning folder names."</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ AOI_dir      : chr "aleza"</span></span>
<span><span class="co">#&gt;  $ raw_dir      : chr "aleza/00_raw_inputs"</span></span>
<span><span class="co">#&gt;  $ shape_raw_dir: chr "aleza/00_raw_inputs/vector/raw"</span></span>
<span><span class="co">#&gt;  $ derived_dir  : chr "aleza/10_map_inputs"</span></span>
<span><span class="co">#&gt;  $ cov_dir      : chr "aleza/10_clean_inputs/covariates"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="alignment-of-the-area-of-interest">Alignment of the area of interest<a class="anchor" aria-label="anchor" href="#alignment-of-the-area-of-interest"></a>
</h2>
<p>Load the spatial data</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aoi</span>   <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/aleza_nw.gpkg"</span>, </span>
<span>                                 package <span class="op">=</span> <span class="st">"PEMprepr"</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span> <span class="co">## note extent</span></span>
<span><span class="co">#&gt;    xmin    ymin    xmax    ymax </span></span>
<span><span class="co">#&gt; 1250797 1013823 1257215 1019097</span></span></code></pre></div>
<p>One concern, with this <em>area-of-interest</em> (<code>aoi</code>)
(red area) is that the bounding box or geographic extent of the area
ends with very random numbers (output above). Using this extent will
cause significant problems later when we attempt to stack numerous
rasters.</p>
<div class="section level3">
<h3 id="snap-the-extent">Snap the extent<a class="anchor" aria-label="anchor" href="#snap-the-extent"></a>
</h3>
<p>Here the <code>aoi</code> is snapped to an extent divisible by 100.
This will facilitate the generation of rasters data that all fits this
grid extent and thereby can be stacked with relative ease.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aoi_snap.html">aoi_snap</a></span><span class="op">(</span><span class="va">aoi</span>, method <span class="op">=</span> <span class="st">"shrink"</span><span class="op">)</span> <span class="co">## or expand</span></span>
<span><span class="co">#&gt; [1] "initial extent is:"</span></span>
<span><span class="co">#&gt;    xmin    ymin    xmax    ymax </span></span>
<span><span class="co">#&gt; 1250797 1013823 1257215 1019097 </span></span>
<span><span class="co">#&gt; [1] "Extent is:"</span></span>
<span><span class="co">#&gt;    xmin    ymin    xmax    ymax </span></span>
<span><span class="co">#&gt; 1250800 1013900 1257200 1019000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="raster-templates">Raster templates<a class="anchor" aria-label="anchor" href="#raster-templates"></a>
</h3>
<p>The snapped <code>aoi</code> can now be used to create a raster
template. In the example below a 25m<sup>2</sup> raster template is
created.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t25</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_template.html">create_template</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">t25</span> <span class="co">## note that the extent of the raster is the same as the aoi. </span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 204, 256, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 25, 25  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 1250800, 1257200, 1013900, 1019000  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : NAD83 / BC Albers (EPSG:3005) </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : lyr.1 </span></span>
<span><span class="co">#&gt; min value   :     0 </span></span>
<span><span class="co">#&gt; max value   :     0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="generation-of-covariates">Generation of covariates<a class="anchor" aria-label="anchor" href="#generation-of-covariates"></a>
</h2>
<p>Here we generate the terrain derived covariates. This is powered by
<a href="https://saga-gis.sourceforge.io/en/index.html" class="external-link">SAGA-GIS</a>.
Covariates are generated at multiple resolutions, for example 5, 10, and
25m<sup>2</sup>.</p>
<p>Steps to create the covariates</p>
<ol style="list-style-type: decimal">
<li>load a digital terrain model (<code>dtm</code>). Generally, this
will be a high resolution model derived from lidar.</li>
<li>align the <code>dtm</code> to the template. resample the
<code>dtm</code> to the desired resolution – here we demonstrate using
the 25m<sup>2</sup> templated created above.</li>
<li>create the covariates</li>
</ol>
<div class="section level3">
<h3 id="import-the-terrain-model">Import the terrain model<a class="anchor" aria-label="anchor" href="#import-the-terrain-model"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtm</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/aleza_nw.tif"</span>,</span>
<span>                               package <span class="op">=</span> <span class="st">"PEMprepr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dtm</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 1170, 1408, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 5.000284, 5.000422  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 1250480, 1257520, 1013524, 1019375  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : NAD83 / BC Albers (EPSG:3005) </span></span>
<span><span class="co">#&gt; source      : aleza_nw.tif </span></span>
<span><span class="co">#&gt; name        : aleza_nw</span></span></code></pre></div>
<div class="figure">
<img src="aleza_aoi_dtm.png" alt="A raw digital terrain model with the area-of-interest noted in red. All processed rasters will align with the aoi." width="390"><p class="caption">
A raw digital terrain model with the area-of-interest noted in red. All
processed rasters will align with the aoi.
</p>
</div>
</div>
<div class="section level3">
<h3 id="align-the-raster">Align the raster<a class="anchor" aria-label="anchor" href="#align-the-raster"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtm25</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/align_raster.html">align_raster</a></span><span class="op">(</span><span class="va">dtm</span>, <span class="va">t25</span><span class="op">)</span></span>
<span><span class="va">dtm25</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 204, 256, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 25, 25  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 1250800, 1257200, 1013900, 1019000  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : NAD83 / BC Albers (EPSG:3005) </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : aleza_nw </span></span>
<span><span class="co">#&gt; min value   : 595.0263 </span></span>
<span><span class="co">#&gt; max value   : 704.1022</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-the-covariates">Create the covariates<a class="anchor" aria-label="anchor" href="#create-the-covariates"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">layer_options</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Filled_sinks"</span>, <span class="st">"sinkroute"</span>, <span class="st">"dem_preproc"</span>, </span>
<span>    <span class="st">"slope_aspect_curve"</span>, <span class="st">"tCatchment"</span>, <span class="st">"tca"</span>, <span class="st">"sCatchment"</span>, </span>
<span>    <span class="st">"twi"</span>, <span class="st">"channelsNetwork"</span>, <span class="st">"Distance2Water"</span>, </span>
<span>    <span class="st">"MultiResFlatness"</span>, <span class="st">"MultiResFlatness2"</span>,</span>
<span>    <span class="st">"MultiResFlatness3"</span>, <span class="st">"TRI"</span>, <span class="st">"convergence"</span>, <span class="st">"Openness"</span>,</span>
<span>    <span class="st">"dah"</span>, <span class="st">"TPI"</span>, <span class="st">"RidgeValley"</span>, <span class="st">"MRN"</span>, <span class="st">"FlowAccumulation"</span>,</span>
<span>    <span class="st">"SlopeLength"</span>, <span class="st">"FlowAccumulation2"</span>, <span class="st">"FlowAccumulation3"</span>,</span>
<span>    <span class="st">"FlowPathLength"</span>, <span class="st">"FlowPathLength2"</span>, <span class="st">"FlowPathLength3"</span>, </span>
<span>    <span class="st">"LSFactor"</span>, <span class="st">"SolarRad"</span>, <span class="st">"Convexity"</span>, <span class="st">"VertDistance"</span>, <span class="st">"TCI_low"</span>,</span>
<span>    <span class="st">"SWI"</span>, <span class="st">"WindExp"</span>, <span class="st">"Texture"</span>, <span class="st">"Protection"</span>, <span class="st">"VRM"</span>,</span>
<span>    <span class="st">"MBI"</span>, <span class="st">"mscale_TPI"</span>, <span class="st">"RelPosition"</span>, <span class="st">"SlopeCurvatures"</span>,</span>
<span>    <span class="st">"SteepestSlope"</span>, <span class="st">"UpslopeArea"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/create_covariates.html">create_covariates</a></span><span class="op">(</span>dtm <span class="op">=</span> <span class="va">dtm25</span>,           <span class="co">## raster created above</span></span>
<span>                  SAGApath <span class="op">=</span> <span class="st">"c:/SAGA/"</span>, <span class="co">## Where SAGA GIS is installed</span></span>
<span>                  output <span class="op">=</span> <span class="va">fstr</span><span class="op">$</span><span class="va">cov_dir</span>, <span class="co">## from the setup_folders above</span></span>
<span>                  layers <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>        <span class="co">## use all or one of the above</span></span></code></pre></div>
<p>Note that the pre-defined output directory <code>fstr$cov_dir</code>,
created using <code><a href="../reference/setup_folders.html">setup_folders()</a></code>, is used to ensure generated
covariates are saved to the correct location. Rasters are also saved
into subfolders of the same resolution.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">fstr</span><span class="op">$</span><span class="va">cov_dir</span>, pattern <span class="op">=</span> <span class="st">".sdat"</span>,</span>
<span>                recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="va">l</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"xml"</span>,<span class="va">l</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## created covariates </span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">l</span>, <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt;  [1] "25/aspect.sdat"              </span></span>
<span><span class="co">#&gt;  [2] "25/cnetwork.sdat"            </span></span>
<span><span class="co">#&gt;  [3] "25/convergence.sdat"         </span></span>
<span><span class="co">#&gt;  [4] "25/convexity.sdat"           </span></span>
<span><span class="co">#&gt;  [5] "25/dah.sdat"                 </span></span>
<span><span class="co">#&gt;  [6] "25/dem_preproc.sdat"         </span></span>
<span><span class="co">#&gt;  [7] "25/diffinso.sdat"            </span></span>
<span><span class="co">#&gt;  [8] "25/direinso.sdat"            </span></span>
<span><span class="co">#&gt;  [9] "25/down_curv.sdat"           </span></span>
<span><span class="co">#&gt; [10] "25/dtm.sdat"                 </span></span>
<span><span class="co">#&gt; [11] "25/Filled_sinks.sdat"        </span></span>
<span><span class="co">#&gt; [12] "25/flow_accum_ft.sdat"       </span></span>
<span><span class="co">#&gt; [13] "25/flow_accum_p.sdat"        </span></span>
<span><span class="co">#&gt; [14] "25/flow_accum_td.sdat"       </span></span>
<span><span class="co">#&gt; [15] "25/flowlength1.sdat"         </span></span>
<span><span class="co">#&gt; [16] "25/FlowPathLenTD.sdat"       </span></span>
<span><span class="co">#&gt; [17] "25/gencurve.sdat"            </span></span>
<span><span class="co">#&gt; [18] "25/hdistnob.sdat"            </span></span>
<span><span class="co">#&gt; [19] "25/local_curv.sdat"          </span></span>
<span><span class="co">#&gt; [20] "25/local_downslope_curv.sdat"</span></span></code></pre></div>
<center>
<em>Note: As SAGA-GIS is used the files resulting files are all saved in
<code>.sdat</code> format – this is read/writable by
<code><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">terra::rast</a></code></em>
</center>
</div>
</div>
<div class="section level2">
<h2 id="creation-of-the-multi-resolution-raster-stack">Creation of the multi-resolution raster stack<a class="anchor" aria-label="anchor" href="#creation-of-the-multi-resolution-raster-stack"></a>
</h2>
<p>Generation of the covariates above is repeated for each resolution in
the multi-resolution model. In order to make all of the rasters
stackable, necessary for model and map generation, they must all have
the same extent and resolution.</p>
<p>The process above ensures they all have the same extent.</p>
<p>Next the coarse resolution rasters are <em>disaggregated</em> to a
fine scale resolution. This means that the data in the resulting raster
is the data of the coarse-raster but in a fine scale format.</p>
<center>
<em>Note: it is highly recommended to use <code>full.names = TRUE</code>
to list the files.</em>
</center>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## we can use the list of files from above</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">fstr</span><span class="op">$</span><span class="va">cov_dir</span>,</span>
<span>                pattern <span class="op">=</span> <span class="st">".sdat"</span>,</span>
<span>                full.names <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">## Use TRUE</span></span>
<span>                recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="va">l</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"xml"</span>,<span class="va">l</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/create_fine_res.html">create_fine_res</a></span><span class="op">(</span>inputFileList <span class="op">=</span> <span class="va">l</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,     <span class="co">## using the list of files above  </span></span>
<span>                output <span class="op">=</span> <span class="va">fstr</span><span class="op">$</span><span class="va">cov_dir</span>, <span class="co">## from setup_folders())</span></span>
<span>                targetRes <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; [1] "Processing: aleza/10_clean_inputs/covariates/25/aspect.sdat"</span></span>
<span><span class="co">#&gt; [1] "Created: aleza/10_clean_inputs/covariates/5/aspect_25.sdat"</span></span>
<span><span class="co">#&gt; [1] "Processing: aleza/10_clean_inputs/covariates/25/cnetwork.sdat"</span></span>
<span><span class="co">#&gt; [1] "Created: aleza/10_clean_inputs/covariates/5/cnetwork_25.sdat"</span></span>
<span><span class="co">#&gt; [1] "Processing: aleza/10_clean_inputs/covariates/25/convergence.sdat"</span></span>
<span><span class="co">#&gt; [1] "Created: aleza/10_clean_inputs/covariates/5/convergence_25.sdat"</span></span>
<span><span class="co">#&gt; ...</span></span></code></pre></div>
<p>This script is a wrapper for <code>terra::disaggregate</code>.</p>
</div>
<div class="section level2">
<h2 id="collection-of-vector-data">Collection of vector data<a class="anchor" aria-label="anchor" href="#collection-of-vector-data"></a>
</h2>
<p>A standard set of Vector data is used for subsequent sample planning
and is based on the <code>aoi</code>. This script collects numerous
vector layers from the <a href="https://catalogue.data.gov.bc.ca" class="external-link">BC
Data Catalogue</a> making use of the <a href="https://github.com/bcgov/bcdata" class="external-link"><code>bcdata</code></a>
package</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_base_vectors.html">create_base_vectors</a></span><span class="op">(</span>in_aoi <span class="op">=</span> <span class="va">aoi</span>,</span>
<span>                    out_path <span class="op">=</span> <span class="va">fstr</span><span class="op">$</span><span class="va">shape_raw_dir</span><span class="op">)</span></span></code></pre></div>
<p>files are saved in <em>geopackage</em> format.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Colin Chisholm, Gen Perkins, Will MacKenzie.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
